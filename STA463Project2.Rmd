---
title: "STA463Project2"
author: "Steve, Jairus, Allen"
date: "2023-04-27"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(GGally)
library(ggfortify)
library(car)
```


## I. Introduction  

This project explores a dataset pertaining to Airbnb prices in Amsterdam during weekdays. Each Airbnb listing is an observation, and is evaluated for room types, cleanliness, and distance from Amsterdam's city center.

Our variables under consideration:

* Y = price (Euros) 
* X1 = room_type (categorical: Private room, Entire home/apt)
* X2 = dist (distance from city center in kilometers)
* X3 = cleanliness_rating (numerical, ranging from 4 to 10)

We will first identify the structure of our dataset:

```{r, echo=FALSE}
airbnb <- read.csv("airbnb.csv")
head(airbnb)
```

This project involves performing a confirmatory multiple regression analysis. Specifically, we seek to answer the following research question: Does the relationship between Airbnb prices in Amsterdam and distance from the city center differ for Airbnbs in private rooms versus Airbnbs in the entire home/apartment versus shared rooms?

=======

## II. Exploratory Data Analysis  
 
In the original Airbnb data set, the column X is merely an index column, and thus should be removed before performing any analyses. We will also remove any rows with N/A values if they are present. Since `room_type` is a categorical variable with 2 factors, we will encode it as a categorical factor variable, where Entire home/apt is 0, Private room is 1, and Shared room is 2.

```{r, echo=FALSE}
airbnb.mod <- airbnb[c("price", "cleanliness_rating", "room_type", "dist")]
#airbnb.mod <- na.omit(airbnb)
#airbnb$room_type <- as.factor (airbnb$room_type)
#airbnb$room_type <- as.numeric(airbnb$room_type)
airbnb.mod$private_room <-ifelse(airbnb$room_type == 'Private room', 1, 0)
airbnb.mod$shared_room <-ifelse(airbnb$room_type == 'Shared room', 1, 0)
airbnb.mod <- airbnb.mod[,-3]
head(airbnb.mod)
```

We have removed all unnecessary columns and rows from our data set. Now we can create a scatter plot and correlation matrix of our variables: 


```{r, echo=FALSE}
#pairs(airbnb)
#create scatterplot matrix with ggplot
ggpairs(airbnb.mod)
cor(airbnb.mod)
```

It appears the graphs are heavily skewed. Price is skewed to the right; cleanliness rating is skewed to the left, and distance is skewed to the right. Since price, cleanliness rating, and distance are skewed, we will transform these variables later in our model and analysis. There seems to be a moderate negative correlation between private room and price of -0.434, an extremely weak positive correlation between cleanliness rating and price of 0.023, and a weak negative correlation between distance and price of -0.259. Also, there does not appear to be any multicollinearity between the predictors. For example, there is an extremely weak positive correlation coefficient of 0.032 between private room and cleanliness rating; an extremely weak negative correlation coefficient of -0.022 between distance and cleanliness rating; a weak negative correlation coefficient of -0.027 between shared room and cleanliness rating. There is a weak positive correlation between private room and distance of 0.102, and an extremely weak positive correlation between shared room and distance of 0.039, and an extremely weak negative correlation between private room and shared room of -0.075.

In context of our hypothesis question, there is a moderate negative correlation coefficient between private room and price, suggesting that the price is lower if the Airbnb is a private room than it would be if the Airbnb is the entire home/apartment. Similarly with a shared room, we have an extremely weak negative correlation between shared room and price, meaning if the Airbnb is a shared room, we expect the price to be lower than if the Airbnb was an entire home/apartment. Furthermore, there is a weak negative correlation between distance and price, meaning that the closer the Airbnb is to the center of the city (i.e. distance decreases), the price of the Airbnb increases. We will analyze these relationships further in our analysis section.

We will examine the distribution of Airbnb prices grouped by Airbnb room types through box plots.

```{r, echo=FALSE}
# Create box plots
ggplot(airbnb, aes(x=room_type, y=price,group=room_type)) + 
  geom_boxplot()
tapply(airbnb$price, airbnb$room_type, summary)
```

From the box plots, we can see that the range of prices for `Entire home/apt`, `Private room` and `Shared room` are very different. `Entire home/apt` ranges from a min of 128.90 Euros to a max of 7,78.90 Euros while the other two categories have much smaller ranges with `Private room` having a range from 143.7 to 1714.40 Euros and `Shared room` ranging from 192.90 to 479.2 Euros. The median prices are not as different with `Entire home/apt` being 625.30 Euros, `Private room` being 319.60 Euros and `Shared room` being 258.00 Euros. There are also many outliers in the `Entire home/apt` box plot, the box plot is skewed far right with the highest outlier being more than 4000 Euros from the second highest outlier. The `Private room` box plot also has multiple outliers but it is not as extremely skewed right as the `Entire home/apt` box plot and the `Shared room` boxplot only has one outlier meaning it shows very small signs of skewness. 

=======

## III Model and Analysis




=======

## IV. Conclusion
